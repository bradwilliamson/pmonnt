use crate::local_cache::LocalCacheProvider;

use std::sync::{Arc, Mutex};
use std::time::Instant;

mod cscb;
mod download;
mod info;
mod provider;
mod recent;
mod recent_detections;
mod reputation;
mod taginfo;
mod types;

pub use types::{
    MbApiError, MbComment, MbCscbEntry, MbDownloadResult, MbQueryMeta, MbRecentDetection,
    MbRecentSample, MbSampleInfo, MbTagInfoSample,
};

/// MalwareBazaar provider (abuse.ch)
pub struct MalwareBazaarProvider {
    api_key: Arc<Mutex<Option<String>>>,
    local_cache: Arc<LocalCacheProvider>,
    rate_limit_until: Arc<Mutex<Option<Instant>>>,
    last_query_meta: Arc<Mutex<Option<MbQueryMeta>>>,
    last_sample: Arc<Mutex<Option<MbSampleInfo>>>,
}
